{% extends "base.html" %}

{% block title %}Administration - Quincaillerie Management{% endblock %}

{% block content %}
<main class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8" x-data="adminManager()">
        <!-- Page Header -->
        <div class="mb-8">
            <h1 class="text-3xl font-bold text-gray-900">Panneau d'Administration</h1>
            <p class="text-gray-600 mt-2">Gérez les utilisateurs, paramètres système et configuration</p>
        </div>

        <!-- Admin Menu Tabs -->
        <div class="bg-white rounded-lg shadow mb-8">
            <div class="border-b border-gray-200">
                <nav class="-mb-px flex space-x-8 px-6">
                    <button @click="activeTab = 'users'"
                            :class="activeTab === 'users' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                            class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">
                        <i class="fas fa-users mr-2"></i>Utilisateurs
                    </button>
                    <button @click="activeTab = 'settings'"
                            :class="activeTab === 'settings' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                            class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">
                        <i class="fas fa-cog mr-2"></i>Paramètres
                    </button>
                    <button @click="activeTab = 'backup'"
                            :class="activeTab === 'backup' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                            class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">
                        <i class="fas fa-database mr-2"></i>Sauvegarde
                    </button>
                    <button @click="activeTab = 'logs'"
                            :class="activeTab === 'logs' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                            class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">
                        <i class="fas fa-list-alt mr-2"></i>Journaux
                    </button>
                    <button @click="activeTab = 'system'"
                            :class="activeTab === 'system' ? 'border-blue-500 text-blue-600' : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'"
                            class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm">
                        <i class="fas fa-server mr-2"></i>Système
                    </button>
                </nav>
            </div>
        </div>

        <!-- Users Management -->
        <div x-show="activeTab === 'users'" class="space-y-8">
            <div class="bg-white rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200">
                    <div class="flex justify-between items-center">
                        <h3 class="text-lg font-medium text-gray-900">Gestion des Utilisateurs</h3>
                        <button @click="showUserModal = true" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md flex items-center">
                            <i class="fas fa-plus mr-2"></i>
                            Nouvel Utilisateur
                        </button>
                    </div>
                </div>
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nom</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rôle</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <template x-for="u in users" :key="u.id">
                                <tr class="hover:bg-gray-50">
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900" x-text="u.username"></td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500" x-text="u.role"></td>
                                    <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                        <button @click="editUser(u)" class="text-blue-600 hover:text-blue-900 mr-3"><i class="fas fa-edit"></i></button>
                                        <button @click="deleteUser(u)" class="text-red-600 hover:text-red-900"><i class="fas fa-trash"></i></button>
                                    </td>
                                </tr>
                            </template>
                            <tr x-show="users.length === 0">
                                <td colspan="3" class="px-6 py-4 text-center text-gray-500">Aucun utilisateur</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Settings tab placeholder -->
        <div x-show="activeTab === 'settings'" class="bg-white rounded-lg shadow p-6">
            Paramètres système à venir
        </div>

        <!-- Backup tab placeholder -->
        <div x-show="activeTab === 'backup'" class="bg-white rounded-lg shadow p-6">
            Fonctions de sauvegarde à venir
        </div>

        <!-- Logs tab placeholder -->
        <div x-show="activeTab === 'logs'" class="bg-white rounded-lg shadow p-6">
            Journaux système à venir
        </div>

        <!-- System info tab placeholder -->
        <div x-show="activeTab === 'system'" class="bg-white rounded-lg shadow p-6">
            Informations système à venir
        </div>
</main>
{% endblock %}

{% block extra_scripts %}
<script>
        function adminManager() {
            return {
                activeTab: 'users',
                showUserModal: false,
                users: [],
                newUser: { username: '', pin: '', role: 'employee' },
                init() { this.loadUsers(); },
                loadUsers() { fetch('/api/admin/users').then(r=>r.json()).then(d=>{ if(d.success) this.users = d.users; }); },
                editUser(u) { alert('Editer ' + u.username); },
                deleteUser(u) { alert('Supprimer ' + u.username); }
            }
        }
</script>
{% endblock %}

{% block extra_css %}
<style>
    [x-cloak] { display: none !important; }
</style>
{% endblock %}
